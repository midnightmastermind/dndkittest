{"ast":null,"code":"var _jsxFileName = \"/data/data/com.termux/files/home/dndkittest/src/TaskBox.js\",\n  _s = $RefreshSig$();\n// TaskBox.jsx â€” INSTANCE-ONLY PANEL STORAGE\n\nimport React, { useContext } from \"react\";\nimport { ScheduleContext } from \"./ScheduleContext\";\nimport { useDroppable } from \"@dnd-kit/core\";\nimport { SortableContext, verticalListSortingStrategy } from \"@dnd-kit/sortable\";\nimport SortableItem from \"./SortableItem\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function TaskBox({\n  panelId,\n  instanceIds = []\n}) {\n  _s();\n  const {\n    tasks,\n    setTasks,\n    // <â€” MUST BE HERE\n    instanceStoreRef,\n    panels,\n    setPanels\n  } = useContext(ScheduleContext);\n  const instanceStore = instanceStoreRef.current;\n\n  // --------------------------------------------------------------------\n  // ðŸŸ© FULL LIST DROPPABLE OVERLAY\n  // --------------------------------------------------------------------\n  const {\n    setNodeRef: setListZoneRef,\n    isOver: listIsOver\n  } = useDroppable({\n    id: `dropzone-list-${panelId}`,\n    data: {\n      role: \"taskbox\",\n      panelId\n    }\n  });\n\n  // --------------------------------------------------------------------\n  // ðŸŸ© EMPTY PANEL DROP ZONE\n  // --------------------------------------------------------------------\n  const {\n    setNodeRef: setEmptyZoneRef,\n    isOver: emptyIsOver\n  } = useDroppable({\n    id: `dropzone-empty-${panelId}`,\n    disabled: instanceIds.length > 0,\n    data: {\n      role: \"taskbox-empty\",\n      panelId\n    }\n  });\n\n  // --------------------------------------------------------------------\n  // ðŸŸ© BOTTOM DROP ZONE (append)\n  // --------------------------------------------------------------------\n  const {\n    setNodeRef: setBottomZoneRef\n  } = useDroppable({\n    id: `dropzone-bottom-${panelId}`,\n    data: {\n      role: \"taskbox-bottom\",\n      panelId\n    }\n  });\n\n  // --------------------------------------------------------------------\n  // ðŸŸ© \"Add Task\" â€” creates *single-mode* NEW TASK + instance\n  // --------------------------------------------------------------------\n  const handleAddTask = () => {\n    const taskId = crypto.randomUUID();\n    const instanceId = crypto.randomUUID();\n\n    // Register instance in global store\n    instanceStore[instanceId] = {\n      taskId\n    };\n\n    // Create full task definition\n    const newTask = {\n      taskId,\n      label: `Task ${instanceIds.length + 1}`,\n      duplicateMode: \"single\"\n    };\n\n    // Add task to GLOBAL tasks list\n    setTasks(prev => [...prev, newTask]);\n\n    // Append instance to this TaskBox panel\n    setPanels(prev => prev.map(p => p.id === panelId ? {\n      ...p,\n      props: {\n        ...p.props,\n        instanceIds: [...p.props.instanceIds, instanceId]\n      }\n    } : p));\n  };\n\n  // --------------------------------------------------------------------\n  // ðŸŸ© Sortable list uses INSTANCE IDs only\n  // --------------------------------------------------------------------\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      background: \"rgba(255,255,255,0.05)\",\n      height: \"100%\",\n      display: \"flex\",\n      flexDirection: \"column\"\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: handleAddTask,\n      style: {\n        padding: \"6px 10px\",\n        marginBottom: 8,\n        background: \"#3A4\",\n        borderRadius: 6,\n        color: \"white\",\n        border: \"none\"\n      },\n      children: \"+ Add Task\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        flex: 1,\n        overflowY: \"auto\",\n        padding: 6,\n        overflowX: \"hidden\",\n        position: \"relative\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        ref: setListZoneRef,\n        style: {\n          position: \"absolute\",\n          inset: 0,\n          zIndex: -1,\n          pointerEvents: \"none\"\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 9\n      }, this), instanceIds.length === 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        ref: setEmptyZoneRef,\n        style: {\n          height: 80,\n          borderRadius: 6,\n          border: \"2px dashed rgba(255,255,255,0.2)\",\n          background: emptyIsOver ? \"rgba(80,200,80,0.20)\" : \"rgba(255,255,255,0.06)\",\n          display: \"flex\",\n          alignItems: \"center\",\n          justifyContent: \"center\",\n          color: \"#aaa\",\n          fontSize: 12\n        },\n        children: \"Drop task here\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: \"flex\",\n          flexDirection: \"column\",\n          gap: 6\n        },\n        children: /*#__PURE__*/_jsxDEV(SortableContext, {\n          items: instanceIds,\n          strategy: verticalListSortingStrategy,\n          children: instanceIds.map(instanceId => {\n            const inst = instanceStore[instanceId];\n            if (!inst) return null;\n            const task = tasks.find(t => t.taskId === inst.taskId);\n            if (!task) return null;\n            return /*#__PURE__*/_jsxDEV(SortableItem, {\n              id: instanceId,\n              type: \"taskbox-item\",\n              instanceId: instanceId,\n              taskId: inst.taskId,\n              label: task.label,\n              panelId: panelId // <â€”â€” FIXED\n            }, instanceId, false, {\n              fileName: _jsxFileName,\n              lineNumber: 179,\n              columnNumber: 17\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 167,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 166,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        ref: setBottomZoneRef,\n        style: {\n          height: 40,\n          marginTop: 4,\n          borderRadius: 6\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 194,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 99,\n    columnNumber: 5\n  }, this);\n}\n_s(TaskBox, \"9HL9Qt7Dv6aCTcbKGJWJkyuWzGo=\", false, function () {\n  return [useDroppable, useDroppable, useDroppable];\n});\n_c = TaskBox;\nvar _c;\n$RefreshReg$(_c, \"TaskBox\");","map":{"version":3,"names":["React","useContext","ScheduleContext","useDroppable","SortableContext","verticalListSortingStrategy","SortableItem","jsxDEV","_jsxDEV","TaskBox","panelId","instanceIds","_s","tasks","setTasks","instanceStoreRef","panels","setPanels","instanceStore","current","setNodeRef","setListZoneRef","isOver","listIsOver","id","data","role","setEmptyZoneRef","emptyIsOver","disabled","length","setBottomZoneRef","handleAddTask","taskId","crypto","randomUUID","instanceId","newTask","label","duplicateMode","prev","map","p","props","style","background","height","display","flexDirection","children","onClick","padding","marginBottom","borderRadius","color","border","fileName","_jsxFileName","lineNumber","columnNumber","flex","overflowY","overflowX","position","ref","inset","zIndex","pointerEvents","alignItems","justifyContent","fontSize","gap","items","strategy","inst","task","find","t","type","marginTop","_c","$RefreshReg$"],"sources":["/data/data/com.termux/files/home/dndkittest/src/TaskBox.js"],"sourcesContent":["// TaskBox.jsx â€” INSTANCE-ONLY PANEL STORAGE\n\nimport React, { useContext } from \"react\";\nimport { ScheduleContext } from \"./ScheduleContext\";\n\nimport { useDroppable } from \"@dnd-kit/core\";\nimport {\n  SortableContext,\n  verticalListSortingStrategy,\n} from \"@dnd-kit/sortable\";\n\nimport SortableItem from \"./SortableItem\";\n\nexport default function TaskBox({ panelId, instanceIds = [] }) {\n  const {\n    tasks,\n    setTasks,          // <â€” MUST BE HERE\n    instanceStoreRef,\n    panels,\n    setPanels\n  } = useContext(ScheduleContext);\n\n  const instanceStore = instanceStoreRef.current;\n\n  // --------------------------------------------------------------------\n  // ðŸŸ© FULL LIST DROPPABLE OVERLAY\n  // --------------------------------------------------------------------\n  const { setNodeRef: setListZoneRef, isOver: listIsOver } = useDroppable({\n    id: `dropzone-list-${panelId}`,\n    data: {\n      role: \"taskbox\",\n      panelId,\n    },\n  });\n\n  // --------------------------------------------------------------------\n  // ðŸŸ© EMPTY PANEL DROP ZONE\n  // --------------------------------------------------------------------\n  const { setNodeRef: setEmptyZoneRef, isOver: emptyIsOver } = useDroppable({\n    id: `dropzone-empty-${panelId}`,\n    disabled: instanceIds.length > 0,\n    data: {\n      role: \"taskbox-empty\",\n      panelId,\n    },\n  });\n\n  // --------------------------------------------------------------------\n  // ðŸŸ© BOTTOM DROP ZONE (append)\n  // --------------------------------------------------------------------\n  const { setNodeRef: setBottomZoneRef } = useDroppable({\n    id: `dropzone-bottom-${panelId}`,\n    data: {\n      role: \"taskbox-bottom\",\n      panelId,\n    },\n  });\n\n  // --------------------------------------------------------------------\n  // ðŸŸ© \"Add Task\" â€” creates *single-mode* NEW TASK + instance\n  // --------------------------------------------------------------------\n  const handleAddTask = () => {\n    const taskId = crypto.randomUUID();\n    const instanceId = crypto.randomUUID();\n\n    // Register instance in global store\n    instanceStore[instanceId] = { taskId };\n\n    // Create full task definition\n    const newTask = {\n      taskId,\n      label: `Task ${instanceIds.length + 1}`,\n      duplicateMode: \"single\",\n    };\n\n    // Add task to GLOBAL tasks list\n    setTasks(prev => [...prev, newTask]);\n\n    // Append instance to this TaskBox panel\n    setPanels(prev =>\n      prev.map(p =>\n        p.id === panelId\n          ? {\n            ...p,\n            props: {\n              ...p.props,\n              instanceIds: [...p.props.instanceIds, instanceId],\n            },\n          }\n          : p\n      )\n    );\n  };\n\n  // --------------------------------------------------------------------\n  // ðŸŸ© Sortable list uses INSTANCE IDs only\n  // --------------------------------------------------------------------\n  return (\n    <div\n      style={{\n        background: \"rgba(255,255,255,0.05)\",\n        height: \"100%\",\n        display: \"flex\",\n        flexDirection: \"column\",\n      }}\n    >\n      {/* Add Task button */}\n      <button\n        onClick={handleAddTask}\n        style={{\n          padding: \"6px 10px\",\n          marginBottom: 8,\n          background: \"#3A4\",\n          borderRadius: 6,\n          color: \"white\",\n          border: \"none\",\n        }}\n      >\n        + Add Task\n      </button>\n\n      {/* Scrollable list container */}\n      <div\n        style={{\n          flex: 1,\n          overflowY: \"auto\",\n          padding: 6,\n          overflowX: \"hidden\",\n          position: \"relative\",\n        }}\n      >\n        {/* Invisible droppable overlay */}\n        <div\n          ref={setListZoneRef}\n          style={{\n            position: \"absolute\",\n            inset: 0,\n            zIndex: -1,\n            pointerEvents: \"none\",\n          }}\n        />\n\n        {/* Empty state */}\n        {instanceIds.length === 0 && (\n          <div\n            ref={setEmptyZoneRef}\n            style={{\n              height: 80,\n              borderRadius: 6,\n              border: \"2px dashed rgba(255,255,255,0.2)\",\n              background: emptyIsOver\n                ? \"rgba(80,200,80,0.20)\"\n                : \"rgba(255,255,255,0.06)\",\n              display: \"flex\",\n              alignItems: \"center\",\n              justifyContent: \"center\",\n              color: \"#aaa\",\n              fontSize: 12,\n            }}\n          >\n            Drop task here\n          </div>\n        )}\n\n        {/* Sortable instance list (vertical) */}\n        <div style={{ display: \"flex\", flexDirection: \"column\", gap: 6 }}>\n          <SortableContext\n            items={instanceIds}\n            strategy={verticalListSortingStrategy}\n          >\n            {instanceIds.map((instanceId) => {\n              const inst = instanceStore[instanceId];\n              if (!inst) return null;\n\n              const task = tasks.find((t) => t.taskId === inst.taskId);\n              if (!task) return null;\n\n              return (\n                <SortableItem\n                  key={instanceId}\n                  id={instanceId}\n                  type=\"taskbox-item\"\n                  instanceId={instanceId}\n                  taskId={inst.taskId}\n                  label={task.label}\n                  panelId={panelId}       // <â€”â€” FIXED\n                />\n              );\n            })}\n          </SortableContext>\n        </div>\n\n        {/* Bottom drop zone */}\n        <div\n          ref={setBottomZoneRef}\n          style={{\n            height: 40,\n            marginTop: 4,\n            borderRadius: 6,\n          }}\n        />\n      </div>\n    </div>\n  );\n}\n"],"mappings":";;AAAA;;AAEA,OAAOA,KAAK,IAAIC,UAAU,QAAQ,OAAO;AACzC,SAASC,eAAe,QAAQ,mBAAmB;AAEnD,SAASC,YAAY,QAAQ,eAAe;AAC5C,SACEC,eAAe,EACfC,2BAA2B,QACtB,mBAAmB;AAE1B,OAAOC,YAAY,MAAM,gBAAgB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAE1C,eAAe,SAASC,OAAOA,CAAC;EAAEC,OAAO;EAAEC,WAAW,GAAG;AAAG,CAAC,EAAE;EAAAC,EAAA;EAC7D,MAAM;IACJC,KAAK;IACLC,QAAQ;IAAW;IACnBC,gBAAgB;IAChBC,MAAM;IACNC;EACF,CAAC,GAAGhB,UAAU,CAACC,eAAe,CAAC;EAE/B,MAAMgB,aAAa,GAAGH,gBAAgB,CAACI,OAAO;;EAE9C;EACA;EACA;EACA,MAAM;IAAEC,UAAU,EAAEC,cAAc;IAAEC,MAAM,EAAEC;EAAW,CAAC,GAAGpB,YAAY,CAAC;IACtEqB,EAAE,EAAE,iBAAiBd,OAAO,EAAE;IAC9Be,IAAI,EAAE;MACJC,IAAI,EAAE,SAAS;MACfhB;IACF;EACF,CAAC,CAAC;;EAEF;EACA;EACA;EACA,MAAM;IAAEU,UAAU,EAAEO,eAAe;IAAEL,MAAM,EAAEM;EAAY,CAAC,GAAGzB,YAAY,CAAC;IACxEqB,EAAE,EAAE,kBAAkBd,OAAO,EAAE;IAC/BmB,QAAQ,EAAElB,WAAW,CAACmB,MAAM,GAAG,CAAC;IAChCL,IAAI,EAAE;MACJC,IAAI,EAAE,eAAe;MACrBhB;IACF;EACF,CAAC,CAAC;;EAEF;EACA;EACA;EACA,MAAM;IAAEU,UAAU,EAAEW;EAAiB,CAAC,GAAG5B,YAAY,CAAC;IACpDqB,EAAE,EAAE,mBAAmBd,OAAO,EAAE;IAChCe,IAAI,EAAE;MACJC,IAAI,EAAE,gBAAgB;MACtBhB;IACF;EACF,CAAC,CAAC;;EAEF;EACA;EACA;EACA,MAAMsB,aAAa,GAAGA,CAAA,KAAM;IAC1B,MAAMC,MAAM,GAAGC,MAAM,CAACC,UAAU,CAAC,CAAC;IAClC,MAAMC,UAAU,GAAGF,MAAM,CAACC,UAAU,CAAC,CAAC;;IAEtC;IACAjB,aAAa,CAACkB,UAAU,CAAC,GAAG;MAAEH;IAAO,CAAC;;IAEtC;IACA,MAAMI,OAAO,GAAG;MACdJ,MAAM;MACNK,KAAK,EAAE,QAAQ3B,WAAW,CAACmB,MAAM,GAAG,CAAC,EAAE;MACvCS,aAAa,EAAE;IACjB,CAAC;;IAED;IACAzB,QAAQ,CAAC0B,IAAI,IAAI,CAAC,GAAGA,IAAI,EAAEH,OAAO,CAAC,CAAC;;IAEpC;IACApB,SAAS,CAACuB,IAAI,IACZA,IAAI,CAACC,GAAG,CAACC,CAAC,IACRA,CAAC,CAAClB,EAAE,KAAKd,OAAO,GACZ;MACA,GAAGgC,CAAC;MACJC,KAAK,EAAE;QACL,GAAGD,CAAC,CAACC,KAAK;QACVhC,WAAW,EAAE,CAAC,GAAG+B,CAAC,CAACC,KAAK,CAAChC,WAAW,EAAEyB,UAAU;MAClD;IACF,CAAC,GACCM,CACN,CACF,CAAC;EACH,CAAC;;EAED;EACA;EACA;EACA,oBACElC,OAAA;IACEoC,KAAK,EAAE;MACLC,UAAU,EAAE,wBAAwB;MACpCC,MAAM,EAAE,MAAM;MACdC,OAAO,EAAE,MAAM;MACfC,aAAa,EAAE;IACjB,CAAE;IAAAC,QAAA,gBAGFzC,OAAA;MACE0C,OAAO,EAAElB,aAAc;MACvBY,KAAK,EAAE;QACLO,OAAO,EAAE,UAAU;QACnBC,YAAY,EAAE,CAAC;QACfP,UAAU,EAAE,MAAM;QAClBQ,YAAY,EAAE,CAAC;QACfC,KAAK,EAAE,OAAO;QACdC,MAAM,EAAE;MACV,CAAE;MAAAN,QAAA,EACH;IAED;MAAAO,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAQ,CAAC,eAGTnD,OAAA;MACEoC,KAAK,EAAE;QACLgB,IAAI,EAAE,CAAC;QACPC,SAAS,EAAE,MAAM;QACjBV,OAAO,EAAE,CAAC;QACVW,SAAS,EAAE,QAAQ;QACnBC,QAAQ,EAAE;MACZ,CAAE;MAAAd,QAAA,gBAGFzC,OAAA;QACEwD,GAAG,EAAE3C,cAAe;QACpBuB,KAAK,EAAE;UACLmB,QAAQ,EAAE,UAAU;UACpBE,KAAK,EAAE,CAAC;UACRC,MAAM,EAAE,CAAC,CAAC;UACVC,aAAa,EAAE;QACjB;MAAE;QAAAX,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CAAC,EAGDhD,WAAW,CAACmB,MAAM,KAAK,CAAC,iBACvBtB,OAAA;QACEwD,GAAG,EAAErC,eAAgB;QACrBiB,KAAK,EAAE;UACLE,MAAM,EAAE,EAAE;UACVO,YAAY,EAAE,CAAC;UACfE,MAAM,EAAE,kCAAkC;UAC1CV,UAAU,EAAEjB,WAAW,GACnB,sBAAsB,GACtB,wBAAwB;UAC5BmB,OAAO,EAAE,MAAM;UACfqB,UAAU,EAAE,QAAQ;UACpBC,cAAc,EAAE,QAAQ;UACxBf,KAAK,EAAE,MAAM;UACbgB,QAAQ,EAAE;QACZ,CAAE;QAAArB,QAAA,EACH;MAED;QAAAO,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAK,CACN,eAGDnD,OAAA;QAAKoC,KAAK,EAAE;UAAEG,OAAO,EAAE,MAAM;UAAEC,aAAa,EAAE,QAAQ;UAAEuB,GAAG,EAAE;QAAE,CAAE;QAAAtB,QAAA,eAC/DzC,OAAA,CAACJ,eAAe;UACdoE,KAAK,EAAE7D,WAAY;UACnB8D,QAAQ,EAAEpE,2BAA4B;UAAA4C,QAAA,EAErCtC,WAAW,CAAC8B,GAAG,CAAEL,UAAU,IAAK;YAC/B,MAAMsC,IAAI,GAAGxD,aAAa,CAACkB,UAAU,CAAC;YACtC,IAAI,CAACsC,IAAI,EAAE,OAAO,IAAI;YAEtB,MAAMC,IAAI,GAAG9D,KAAK,CAAC+D,IAAI,CAAEC,CAAC,IAAKA,CAAC,CAAC5C,MAAM,KAAKyC,IAAI,CAACzC,MAAM,CAAC;YACxD,IAAI,CAAC0C,IAAI,EAAE,OAAO,IAAI;YAEtB,oBACEnE,OAAA,CAACF,YAAY;cAEXkB,EAAE,EAAEY,UAAW;cACf0C,IAAI,EAAC,cAAc;cACnB1C,UAAU,EAAEA,UAAW;cACvBH,MAAM,EAAEyC,IAAI,CAACzC,MAAO;cACpBK,KAAK,EAAEqC,IAAI,CAACrC,KAAM;cAClB5B,OAAO,EAAEA,OAAQ,CAAO;YAAA,GANnB0B,UAAU;cAAAoB,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAOhB,CAAC;UAEN,CAAC;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACa;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACf,CAAC,eAGNnD,OAAA;QACEwD,GAAG,EAAEjC,gBAAiB;QACtBa,KAAK,EAAE;UACLE,MAAM,EAAE,EAAE;UACViC,SAAS,EAAE,CAAC;UACZ1B,YAAY,EAAE;QAChB;MAAE;QAAAG,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACC,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACH,CAAC;AAEV;AAAC/C,EAAA,CA/LuBH,OAAO;EAAA,QAc8BN,YAAY,EAWVA,YAAY,EAYhCA,YAAY;AAAA;AAAA6E,EAAA,GArC/BvE,OAAO;AAAA,IAAAuE,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}