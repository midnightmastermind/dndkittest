{"ast":null,"code":"import { useEffect } from 'react';\nimport createFocusTrap from 'focus-trap';\nimport noop from '@atlaskit/ds-lib/noop';\nimport { useLayering } from '@atlaskit/layering';\nimport { fg } from '@atlaskit/platform-feature-flags';\nimport { useAnimationFrame } from './utils/use-animation-frame';\nexport var useFocusManager = function useFocusManager(_ref) {\n  var initialFocusRef = _ref.initialFocusRef,\n    popupRef = _ref.popupRef,\n    triggerRef = _ref.triggerRef,\n    autoFocus = _ref.autoFocus,\n    shouldCloseOnTab = _ref.shouldCloseOnTab,\n    shouldDisableFocusTrap = _ref.shouldDisableFocusTrap,\n    shouldReturnFocus = _ref.shouldReturnFocus,\n    shouldRenderToParent = _ref.shouldRenderToParent;\n  var _useAnimationFrame = useAnimationFrame(),\n    requestFrame = _useAnimationFrame.requestFrame,\n    cancelAllFrames = _useAnimationFrame.cancelAllFrames;\n  var _useLayering = useLayering(),\n    currentLevel = _useLayering.currentLevel;\n  useEffect(function () {\n    if (!popupRef || shouldCloseOnTab) {\n      return noop;\n    }\n    if (shouldDisableFocusTrap && fg('platform_dst_popup-disable-focuslock')) {\n      var isDropdown = popupRef.matches('[id^=ds--dropdown--]');\n      var popups = document.querySelectorAll(\"[data-ds--level=\\\"\".concat(currentLevel - 1, \"\\\"]\"));\n      if (!(popups[popups.length - 1] && !shouldRenderToParent && isDropdown)) {\n        // Plucking trigger & popup content container from the tab order so that\n        // when we Shift+Tab, the focus moves to the element before trigger\n        requestFrame(function () {\n          triggerRef === null || triggerRef === void 0 || triggerRef.setAttribute('tabindex', '-1');\n          if (popupRef && autoFocus) {\n            popupRef.setAttribute('tabindex', '-1');\n          }\n          (initialFocusRef || popupRef).focus();\n        });\n        return noop;\n      }\n    }\n    var trapConfig = {\n      clickOutsideDeactivates: true,\n      escapeDeactivates: true,\n      initialFocus: initialFocusRef || popupRef,\n      fallbackFocus: popupRef,\n      returnFocusOnDeactivate: shouldReturnFocus\n    };\n    var focusTrap = createFocusTrap(popupRef, trapConfig);\n\n    // Wait for the popup to reposition itself before we focus\n    requestFrame(function () {\n      focusTrap.activate();\n    });\n    return function () {\n      cancelAllFrames();\n      focusTrap.deactivate();\n    };\n  }, [popupRef, triggerRef, autoFocus, initialFocusRef, shouldCloseOnTab, shouldDisableFocusTrap, requestFrame, cancelAllFrames, shouldReturnFocus, shouldRenderToParent, currentLevel]);\n};","map":{"version":3,"names":["useEffect","createFocusTrap","noop","useLayering","fg","useAnimationFrame","useFocusManager","_ref","initialFocusRef","popupRef","triggerRef","autoFocus","shouldCloseOnTab","shouldDisableFocusTrap","shouldReturnFocus","shouldRenderToParent","_useAnimationFrame","requestFrame","cancelAllFrames","_useLayering","currentLevel","isDropdown","matches","popups","document","querySelectorAll","concat","length","setAttribute","focus","trapConfig","clickOutsideDeactivates","escapeDeactivates","initialFocus","fallbackFocus","returnFocusOnDeactivate","focusTrap","activate","deactivate"],"sources":["/data/data/com.termux/files/home/dndkittest/node_modules/@atlaskit/popup/dist/esm/use-focus-manager.js"],"sourcesContent":["import { useEffect } from 'react';\nimport createFocusTrap from 'focus-trap';\nimport noop from '@atlaskit/ds-lib/noop';\nimport { useLayering } from '@atlaskit/layering';\nimport { fg } from '@atlaskit/platform-feature-flags';\nimport { useAnimationFrame } from './utils/use-animation-frame';\nexport var useFocusManager = function useFocusManager(_ref) {\n  var initialFocusRef = _ref.initialFocusRef,\n    popupRef = _ref.popupRef,\n    triggerRef = _ref.triggerRef,\n    autoFocus = _ref.autoFocus,\n    shouldCloseOnTab = _ref.shouldCloseOnTab,\n    shouldDisableFocusTrap = _ref.shouldDisableFocusTrap,\n    shouldReturnFocus = _ref.shouldReturnFocus,\n    shouldRenderToParent = _ref.shouldRenderToParent;\n  var _useAnimationFrame = useAnimationFrame(),\n    requestFrame = _useAnimationFrame.requestFrame,\n    cancelAllFrames = _useAnimationFrame.cancelAllFrames;\n  var _useLayering = useLayering(),\n    currentLevel = _useLayering.currentLevel;\n  useEffect(function () {\n    if (!popupRef || shouldCloseOnTab) {\n      return noop;\n    }\n    if (shouldDisableFocusTrap && fg('platform_dst_popup-disable-focuslock')) {\n      var isDropdown = popupRef.matches('[id^=ds--dropdown--]');\n      var popups = document.querySelectorAll(\"[data-ds--level=\\\"\".concat(currentLevel - 1, \"\\\"]\"));\n      if (!(popups[popups.length - 1] && !shouldRenderToParent && isDropdown)) {\n        // Plucking trigger & popup content container from the tab order so that\n        // when we Shift+Tab, the focus moves to the element before trigger\n        requestFrame(function () {\n          triggerRef === null || triggerRef === void 0 || triggerRef.setAttribute('tabindex', '-1');\n          if (popupRef && autoFocus) {\n            popupRef.setAttribute('tabindex', '-1');\n          }\n          (initialFocusRef || popupRef).focus();\n        });\n        return noop;\n      }\n    }\n    var trapConfig = {\n      clickOutsideDeactivates: true,\n      escapeDeactivates: true,\n      initialFocus: initialFocusRef || popupRef,\n      fallbackFocus: popupRef,\n      returnFocusOnDeactivate: shouldReturnFocus\n    };\n    var focusTrap = createFocusTrap(popupRef, trapConfig);\n\n    // Wait for the popup to reposition itself before we focus\n    requestFrame(function () {\n      focusTrap.activate();\n    });\n    return function () {\n      cancelAllFrames();\n      focusTrap.deactivate();\n    };\n  }, [popupRef, triggerRef, autoFocus, initialFocusRef, shouldCloseOnTab, shouldDisableFocusTrap, requestFrame, cancelAllFrames, shouldReturnFocus, shouldRenderToParent, currentLevel]);\n};"],"mappings":"AAAA,SAASA,SAAS,QAAQ,OAAO;AACjC,OAAOC,eAAe,MAAM,YAAY;AACxC,OAAOC,IAAI,MAAM,uBAAuB;AACxC,SAASC,WAAW,QAAQ,oBAAoB;AAChD,SAASC,EAAE,QAAQ,kCAAkC;AACrD,SAASC,iBAAiB,QAAQ,6BAA6B;AAC/D,OAAO,IAAIC,eAAe,GAAG,SAASA,eAAeA,CAACC,IAAI,EAAE;EAC1D,IAAIC,eAAe,GAAGD,IAAI,CAACC,eAAe;IACxCC,QAAQ,GAAGF,IAAI,CAACE,QAAQ;IACxBC,UAAU,GAAGH,IAAI,CAACG,UAAU;IAC5BC,SAAS,GAAGJ,IAAI,CAACI,SAAS;IAC1BC,gBAAgB,GAAGL,IAAI,CAACK,gBAAgB;IACxCC,sBAAsB,GAAGN,IAAI,CAACM,sBAAsB;IACpDC,iBAAiB,GAAGP,IAAI,CAACO,iBAAiB;IAC1CC,oBAAoB,GAAGR,IAAI,CAACQ,oBAAoB;EAClD,IAAIC,kBAAkB,GAAGX,iBAAiB,CAAC,CAAC;IAC1CY,YAAY,GAAGD,kBAAkB,CAACC,YAAY;IAC9CC,eAAe,GAAGF,kBAAkB,CAACE,eAAe;EACtD,IAAIC,YAAY,GAAGhB,WAAW,CAAC,CAAC;IAC9BiB,YAAY,GAAGD,YAAY,CAACC,YAAY;EAC1CpB,SAAS,CAAC,YAAY;IACpB,IAAI,CAACS,QAAQ,IAAIG,gBAAgB,EAAE;MACjC,OAAOV,IAAI;IACb;IACA,IAAIW,sBAAsB,IAAIT,EAAE,CAAC,sCAAsC,CAAC,EAAE;MACxE,IAAIiB,UAAU,GAAGZ,QAAQ,CAACa,OAAO,CAAC,sBAAsB,CAAC;MACzD,IAAIC,MAAM,GAAGC,QAAQ,CAACC,gBAAgB,CAAC,oBAAoB,CAACC,MAAM,CAACN,YAAY,GAAG,CAAC,EAAE,KAAK,CAAC,CAAC;MAC5F,IAAI,EAAEG,MAAM,CAACA,MAAM,CAACI,MAAM,GAAG,CAAC,CAAC,IAAI,CAACZ,oBAAoB,IAAIM,UAAU,CAAC,EAAE;QACvE;QACA;QACAJ,YAAY,CAAC,YAAY;UACvBP,UAAU,KAAK,IAAI,IAAIA,UAAU,KAAK,KAAK,CAAC,IAAIA,UAAU,CAACkB,YAAY,CAAC,UAAU,EAAE,IAAI,CAAC;UACzF,IAAInB,QAAQ,IAAIE,SAAS,EAAE;YACzBF,QAAQ,CAACmB,YAAY,CAAC,UAAU,EAAE,IAAI,CAAC;UACzC;UACA,CAACpB,eAAe,IAAIC,QAAQ,EAAEoB,KAAK,CAAC,CAAC;QACvC,CAAC,CAAC;QACF,OAAO3B,IAAI;MACb;IACF;IACA,IAAI4B,UAAU,GAAG;MACfC,uBAAuB,EAAE,IAAI;MAC7BC,iBAAiB,EAAE,IAAI;MACvBC,YAAY,EAAEzB,eAAe,IAAIC,QAAQ;MACzCyB,aAAa,EAAEzB,QAAQ;MACvB0B,uBAAuB,EAAErB;IAC3B,CAAC;IACD,IAAIsB,SAAS,GAAGnC,eAAe,CAACQ,QAAQ,EAAEqB,UAAU,CAAC;;IAErD;IACAb,YAAY,CAAC,YAAY;MACvBmB,SAAS,CAACC,QAAQ,CAAC,CAAC;IACtB,CAAC,CAAC;IACF,OAAO,YAAY;MACjBnB,eAAe,CAAC,CAAC;MACjBkB,SAAS,CAACE,UAAU,CAAC,CAAC;IACxB,CAAC;EACH,CAAC,EAAE,CAAC7B,QAAQ,EAAEC,UAAU,EAAEC,SAAS,EAAEH,eAAe,EAAEI,gBAAgB,EAAEC,sBAAsB,EAAEI,YAAY,EAAEC,eAAe,EAAEJ,iBAAiB,EAAEC,oBAAoB,EAAEK,YAAY,CAAC,CAAC;AACxL,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}